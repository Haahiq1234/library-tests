<html>
<head>
</head>
<body>
    <script src="Canvas.js"></script>
    <script>
        var FramesPerSecond = 80;
        var balls = [];
        function setUp() {
            createCanvas(400, 400, "white");
            frameRate(FramesPerSecond);
            for (var i = 0; i < 10; i++) {
                balls.push(new Ball(Random.range(CanvasWidth), Random.range(CanvasHeight), Random.range(10, 15), color(255, 0, 0)));
            }
            console.log(balls);
            gravity = new Vector2(0, 0.1);
        }
        function draw() {
            clear();
            for (var i = 0; i < balls.length; i++) {
                balls[i].run();
            }
        }
        class Ball {
            constructor(x, y, r, col, acc) {
                this.pos = new Vector2(x, y);
                this.vel = new Vector2(0, 0);
                this.acc = new Vector2(0, 0);
                this.r = r;
                this.m = r ** 2;
                this.color = col;
                this.maxSpeed = 4;
                this.maxAcc = 0.1;
            }
            edges() {
                this.pos.x = constraint(this.pos.x, this.r, CanvasWidth - this.r);
                this.pos.y = constraint(this.pos.y, this.r, CanvasHeight - this.r);
            }
            addForce(force) {
                force = force.copy().div(this.m);
                this.acc.add(force);
            }
            collide() {
                for (var i = 0; i < balls.length; i++) {
                    if (balls[i] != this) {
                        let coll = checkCircleCollision(this.pos.x, this.pos.y, balls[i].pos.x, balls[i].pos.y, this.r, balls[i].r);
                        if (coll.collision) {
                            this.pos = coll.position1;
                            let temp = balls[i].vel.copy();
                            balls[i].vel = this.vel;
                            this.vel = temp;
                        }
                    }
                }
            }
            update() {
                this.acc.add(Vector.sub(this.pos, mouse).mult(-1));
                this.acc.add(gravity);
                this.acc.limit(this.maxAcc);
                this.vel.add(this.acc);
                this.vel.limit(this.maxSpeed);
                this.pos.add(this.vel);
                this.acc.reset();
            }
            run(i) {
                this.update();
                this.collide();
                this.edges();
                this.draw(i);
            }
            draw(i) {
                fill(this.color);
                ellipse(this.pos.x, this.pos.y, this.r * 2, this.r * 2);
            }
        }
    </script>
</body>
</html>
