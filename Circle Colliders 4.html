<html>
<head>
</head>
<body>
    <script src="Canvas.js"></script>
    <script>
        var FramesPerSecond = 80;
        let ball;
        let shapes = [];
        function setUp() {
            createCanvas(400, 400, "white");
            frameRate(FramesPerSecond);
            ball = new Ball(200, 200, 20);
            gravity = new Vector2(0, 0.1);
            shapes.push(new Shape());
            shapes[0].add(100, 200);
            shapes[0].add(300, 200);
            shapes[0].add(200, 100);
            shapes[0].add(100, 100);
        }
        function draw() {
            clear();
            ball.run();
            for (let sh of shapes) {
                sh.show();
            }
        }
        class Ball {
            constructor(x, y, r) {
                this.pos = new Vector2(x, y);
                this.vel = new Vector2(0, 0);
                this.acc = new Vector2(0, 0);
                this.r = r;
                this.m = r ** 2;
                this.color = color(255, 0, 0);
                this.maxSpeed = 8;
                this.maxAcc = 0.1;
            }
            edges() {
                this.pos.x = constraint(this.pos.x, this.r, CanvasWidth - this.r);
                this.pos.y = constraint(this.pos.y, this.r, CanvasHeight - this.r);
            }
            addForce(force) {
                force = force.copy().div(this.m);
                this.acc.add(force);
            }
            collide() {
                for (let sh of shapes) {
                    let coll = distance.shape(this.pos.x, this.pos.y, ...sh.vertices);
                    line(this.pos.x, this.pos.y, coll.point.x, coll.point.y);
                }
            }
            update() {
                //let d = mouse.copy();
                //d.sub(this.pos);
                //d.limit(this.maxSpeed);
                //d.sub(this.vel);
                //d.limit(this.maxAcc);
                //this.acc.add(d);
                this.pos = mouse.copy();
                this.vel.add(this.acc);
                this.vel.limit(this.maxSpeed);
                this.pos.add(this.vel);
                this.acc.reset();
            }
            run(i) {
                this.update();
                this.collide();
                this.edges();
                this.draw(i);
            }
            draw(i) {
                fill(this.color);
                circle(this.pos.x, this.pos.y, this.r);
            }
        } // ball 
        function Shape() {
            this.vertices = [];
            this.show = function () {
                nofill("red");
                shape.begin();
                for (let i = 0; i < this.vertices.length; i += 2) {
                    shape.addVertex(this.vertices[i], this.vertices[i + 1]);
                }
                shape.close();
            }
            this.add = function (x, y) {
                this.vertices.push(x, y);
            }
        }
    </script>
</body>
</html>
